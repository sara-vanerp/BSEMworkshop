---
title: "Bayesian Sructural Equation Modeling"
author: "Sara van Erp [TODO: add info]"
date: "09-03-2022"
output: 
  ioslides_presentation: 
    incremental: true
---

## Overview

- Introduction
  + Bayesian analysis
  + Why use Bayesian SEM?
  + Why not to use Bayesian SEM?
- Break
- Prior specification
  + Hands-on session prior specification
- A Bayesian SEM example
- Exercises
- Additional information

# Introduction 

## Bayesian analysis 

<div style="float: left; width: 50%;">
**Frequentist estimation** 
<ul>
  <li>Probability as long-run relative frequency</li>  
  <li>Parameters are fixed</li> 
  <li>Estimation through optimization</li> 
</ul>
</div>

<div style="float: right; width: 50%;">
**Bayesian estimation**  
<ul>
  <li>Probability as belief</li>   
  <li>Parameters are random and can be assigned a *prior*</li>   
  <li>Estimation through sampling</li> 
</ul>
</div>

## Bayesian analysis {.build}

Bayesian estimation relies on the data and the prior: 
$$
p(\pmb{\theta}|Y) \propto p(Y|\pmb{\theta})p(\pmb{\theta})
$$

```{r eval = TRUE, echo = FALSE}
# TODO: add plot prior, likelihood and posterior
plot(density(rnorm(100)))
```

## Why use Bayesian SEM?

Bayesian SEM: specify a prior for each parameter and build the posterior using MCMC sampling.

*Advantages*

- Add information via the prior
  - smaller samples needed
  - regularization of estimates
- More complex models can be estimated
- Automatic uncertainty estimates

## Why not to use Bayesian SEM?

- Add information via the prior
- MCMC sampling requires assessment of convergence
- Relatively novel
  - active area of research
  - availability in software
  - researchers unfamiliar

# Questions?

# Prior specification

## Types of priors

- Priors vary in the amount of information they carry
- From "non-informative" to highly informative
- Informativeness of the prior depends on the problem

<br>
<br>

```{r fig.show = "hold", out.width = "33%", eval = TRUE, echo = FALSE}
n <- 10e5

# non-informative
sd1 <- sqrt(10^10)
plot(density(rnorm(n, mean = 0, sd = sd1)),
     type = "l",
     yaxt = "n",
     xlab = "",
     ylab = "",
     main = "Normal(0, 10^10)",
     xlim = c(-5, 5))

# informative
sd2 <- 1
plot(density(rnorm(n, mean = 0, sd = sd2)),
     type = "l",
     yaxt = "n",
     xlab = "",
     ylab = "",
     main = "Normal(0, 1)",
     xlim = c(-5, 5))

# highly informative
sd3 <- 0.1
plot(density(rnorm(n, mean = 0, sd = sd3)),
     type = "l",
     yaxt = "n",
     xlab = "",
     ylab = "",
     main = "Normal(0, 0.01)",
     xlim = c(-5, 5))

```

## A warning on default priors

- Traditionally, heavy reliance on "default" priors
- Adding no information through the prior can give the same results as ML
- But: default priors can inadvertently influence the results, e.g. IG(.001, .001) prior (van Erp et al. (2018); van Erp & Browne (2021))
- Some software programs are not explicit about their priors, but it can be influential

## The power of the prior

- Weakly informative priors to regularize estimates
- Informative priors to include prior research or expert opinions
- Shrinkage priors to identify non-identified models

## How to be careful with the prior

- Carefully consider the priors (or look up the automatic defaults)
- Plot the priors (prior predictive checks)
- Conduct a prior sensitivity analysis

## Hands-on: Prior specification with Shiny BSEM

Go to: ... \

Think about reasonable priors for all parameters (or use the defaults) and inspect the results. \

Change the priors to see how this influences the results. 

# A Bayesian SEM example with blavaan

## Political democracy example
<img src="PD_model.png" alt="model" width="450"/>

# Exercises

# Additional information

## References 

*Bayesian introductory texts*

TODO: add links

<font size = "3">
Etz, A., Gronau, Q. F., Dablander, F., Edelsbrunner, P. A., & Baribault, B. (2017). How to become a Bayesian in eight easy steps: An annotated reading list. Psychonomic Bulletin & Review, 25(1), 219â€“234. \

Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, A., & Rubin, D. B. (2013). Bayesian data analysis (3rd ed.). Chapman and Hall/CRC.
</font>

BSEM book Depaoli

*Prior sensitivity*
Van Erp, S., Mulder, J., & Oberski, D. L. (2018). Prior sensitivity analysis in default bayesian structural equation modeling. Psychological Methods, 23(2), 363-388. \

Van Erp, S. & Browne, W. J. (2021). Bayesian Multilevel Structural Equation Modeling: An Investigation into Robust Prior Distributions for the Doubly Latent Categorical Model. Structural Equation Modeling: A Multidisciplinary Journal, 28:6, 875-893.
